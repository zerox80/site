{{ define "main" }}
  {{ with .Site.Params.hero }}
    <section class="hero">
      <div class="container hero-grid">
        <div>
          <p class="eyebrow">{{ .eyebrow }}</p>
          <h1>{{ .title }}</h1>
          <p class="lead">{{ .subtitle }}</p>
          <div class="cta-group">
            <a class="btn btn-primary" href="{{ .primary_cta.url }}">{{ .primary_cta.label }}</a>
            <a class="btn btn-ghost" href="{{ .secondary_cta.url }}">{{ .secondary_cta.label }}</a>
          </div>
          <ul class="hero-highlights">
            {{ range .highlights }}
              <li>{{ . }}</li>
            {{ end }}
          </ul>
        </div>
        <div class="hero-card">
          <h2>{{ .card.title }}</h2>
          <ol>
            {{ range .card.steps }}
              <li>
                <strong>{{ .title }}</strong>
                <span>{{ .description }}</span>
              </li>
            {{ end }}
          </ol>
        </div>
      </div>
    </section>
  {{ end }}

  {{ with .Site.Params.features }}
    <section id="learn" class="section">
      <div class="container">
        <h2>{{ .title }}</h2>
        <p class="section-lead">{{ .subtitle }}</p>
        <div class="grid feature-grid">
          {{ range .items }}
            <article>
              <h3>{{ .title }}</h3>
              <p>{{ .description }}</p>
              <ul>
                {{ range .points }}
                  <li>{{ . }}</li>
                {{ end }}
              </ul>
            </article>
          {{ end }}
        </div>
      </div>
    </section>
  {{ end }}

  {{ $allPosts := sort (where .Site.RegularPages "Section" "posts") "Date" "desc" }}
  {{ $featured := first 3 $allPosts }}
  {{ if gt (len $featured) 0 }}
    <section class="section alt" id="guides">
      <div class="container">
        <h2>Aktuelle Guides</h2>
        <p class="section-lead">Schritt-fuer-Schritt-Anleitungen, die du direkt anwenden kannst.</p>
        <div class="grid articles-grid">
          {{ range $featured }}
            <article class="card">
              <header>
                <p class="card-eyebrow">{{ .Params.level | default "Guide" }}</p>
                <h3><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
              </header>
              <p>{{ .Summary }}</p>
              <footer class="card-meta">
                <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "02. Januar 2006" }}</time>
                <a class="text-link" href="{{ .RelPermalink }}">Zum Guide</a>
              </footer>
            </article>
          {{ end }}
        </div>
        <div class="cta-center">
          <a class="btn btn-secondary" href="{{ "/posts/" | relLangURL }}">Alle Beitraege ansehen</a>
        </div>
      </div>
    </section>
  {{ end }}

  {{ $remaining := slice }}
  {{ if gt (len $allPosts) 3 }}
    {{ $remaining = after 3 $allPosts }}
  {{ end }}
  {{ if gt (len $remaining) 0 }}
    <section class="section" id="latest">
      <div class="container">
        <h2>Neueste Inhalte</h2>
        <p class="section-lead">Bleib auf dem Laufenden: Diese Beitraege sind kuerzlich erschienen.</p>
        <div class="grid articles-list">
          {{ range first 6 $remaining }}
            <article class="media-card">
              <div>
                <p class="card-eyebrow">{{ .Params.level | default "Guide" }}</p>
                <h3><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
                <p class="muted">{{ .Summary | plainify | truncate 160 }}</p>
              </div>
              <footer class="card-meta">
                <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "02. Januar 2006" }}</time>
                {{ with .Params.categories }}
                  <span>{{ delimit . ", " }}</span>
                {{ end }}
              </footer>
            </article>
          {{ end }}
        </div>
      </div>
    </section>
  {{ end }}

  {{ $sections := where .Site.Sections "Section" "!=" "" }}
  {{ if gt (len $sections) 0 }}
    <section class="section alt" id="explore">
      <div class="container">
        <h2>Inhalte nach Themen erkunden</h2>
        <p class="section-lead">Jeder Bereich enthaelt eigenstaendige Lernpfade und vertiefende Guides.</p>
        <div class="grid section-grid">
          {{ range $sections }}
            <article class="card section-card">
              <header>
                <p class="card-eyebrow">{{ .Section | humanize }}</p>
                <h3><a href="{{ .RelPermalink }}">{{ .Title | default (.Section | humanize) }}</a></h3>
              </header>
              <p>{{ .Summary | default (cond (gt (len .RegularPages) 0) (index (.RegularPages.ByDate.Reverse) 0).Summary "Neue Inhalte folgen bald.") | plainify | truncate 160 }}</p>
              <footer class="card-meta">
                <span>{{ len .RegularPages }} Inhalte</span>
                <a class="text-link" href="{{ .RelPermalink }}">Bereich ansehen</a>
              </footer>
            </article>
          {{ end }}
        </div>
      </div>
    </section>
  {{ end }}

  {{ if .Site.Taxonomies.tags }}
    {{ $tagList := slice }}
    {{ range $name, $taxonomy := .Site.Taxonomies.tags }}
      {{ $tagList = $tagList | append (dict "name" $name "term" $taxonomy) }}
    {{ end }}
    {{ $tagList = sort $tagList "name" }}
    <section class="section" id="topics">
      <div class="container narrow">
        <h2>Beliebte Tags</h2>
        <p class="section-lead">Nutze Tags, um schnell passende Tutorials und Cheatsheets zu finden.</p>
        <ul class="tag-list">
          {{ range $tag := first 30 $tagList }}
            <li>
              <a href="{{ $tag.term.Page.RelPermalink }}">
                <span>#{{ $tag.name }}</span>
                <span class="count">{{ len $tag.term.Pages }}</span>
              </a>
            </li>
          {{ end }}
        </ul>
      </div>
    </section>
  {{ end }}

  {{ with .Site.Params.timeline }}
    <section id="path" class="section">
      <div class="container narrow">
        <h2>{{ .title }}</h2>
        <p class="section-lead">{{ .subtitle }}</p>
        <ol class="timeline">
          {{ range .steps }}
            <li>
              <div class="timeline-step">
                <span class="timeline-number">{{ .number }}</span>
                <div>
                  <h3>{{ .title }}</h3>
                  <p>{{ .description }}</p>
                </div>
              </div>
            </li>
          {{ end }}
        </ol>
      </div>
    </section>
  {{ end }}

  {{ with .Site.Params.testimonials }}
    <section class="section alt" id="community">
      <div class="container">
        <h2>{{ .title }}</h2>
        <p class="section-lead">{{ .subtitle }}</p>
        <div class="grid testimonials-grid">
          {{ range .items }}
            <figure>
              <blockquote>"{{ .quote }}"</blockquote>
              <figcaption>
                <span class="name">{{ .name }}</span>
                <span class="role">{{ .role }}</span>
              </figcaption>
            </figure>
          {{ end }}
        </div>
      </div>
    </section>
  {{ end }}

  {{ with .Site.Params.final_cta }}
    <section class="section final-cta">
      <div class="container final-cta-box">
        <div>
          <h2>{{ .title }}</h2>
          <p>{{ .subtitle }}</p>
        </div>
        <a class="btn btn-primary" href="{{ .url }}">{{ .label }}</a>
      </div>
    </section>
  {{ end }}
{{ end }}
